<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meteor Shooter</title>
<style>
  body, html { margin:0; padding:0; overflow:hidden; font-family:sans-serif; background:#000; color:#fff; }
  canvas { display:block; background:#000; }
  #menu, #platformSelect, #settings, #credits { 
    position:absolute; top:0; left:0; width:100%; height:100%; 
    display:flex; flex-direction:column; align-items:center; justify-content:center; 
    background:rgba(0,0,0,0.9); z-index:10;
  }
  button { margin:10px; padding:15px 30px; font-size:20px; cursor:pointer; border:none; border-radius:5px; background:#222; color:#fff; }
  #joystickContainer { position:absolute; bottom:30px; left:30px; width:100px; height:100px; background:rgba(255,255,255,0.1); border-radius:50%; display:none; touch-action:none; }
  #joystick { width:50px; height:50px; background:rgba(255,255,255,0.3); border-radius:50%; position:absolute; top:25px; left:25px; }
</style>
</head>
<body>

<div id="menu">
  <button onclick="startGame()">Jogar</button>
  <button onclick="showSettings()">Configurações</button>
  <button onclick="showCredits()">Créditos</button>
</div>

<div id="platformSelect" style="display:none;">
  <h2>Escolha sua plataforma</h2>
  <button onclick="initGame('pc')">PC</button>
  <button onclick="initGame('mobile')">Mobile</button>
</div>

<div id="settings" style="display:none;">
  <h2>Configurações</h2>
  <p>Em breve...</p>
  <button onclick="backToMenu()">Voltar</button>
</div>

<div id="credits" style="display:none;">
  <h2>Créditos</h2>
  <p>Feito por Atos016</p>
  <button onclick="backToMenu()">Voltar</button>
</div>

<canvas id="gameCanvas"></canvas>
<div id="joystickContainer">
  <div id="joystick"></div>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let gameStarted = false;
let platform = 'pc';
let keys = {};
let bullets = [];
let meteors = [];
let player = {x:canvas.width/2, y:canvas.height-50, width:40, height:40, speed:5};
let joystick = {x:0, y:0, active:false};

function startGame() {
  document.getElementById('menu').style.display='none';
  document.getElementById('platformSelect').style.display='flex';
}

function showSettings() {
  document.getElementById('menu').style.display='none';
  document.getElementById('settings').style.display='flex';
}

function showCredits() {
  document.getElementById('menu').style.display='none';
  document.getElementById('credits').style.display='flex';
}

function backToMenu() {
  document.getElementById('settings').style.display='none';
  document.getElementById('credits').style.display='none';
  document.getElementById('menu').style.display='flex';
}

function initGame(selectedPlatform) {
  platform = selectedPlatform;
  document.getElementById('platformSelect').style.display='none';
  if(platform==='mobile'){
    document.getElementById('joystickContainer').style.display='block';
  }
  gameStarted = true;
  spawnMeteor();
  requestAnimationFrame(gameLoop);
}

function spawnMeteor() {
  meteors.push({x:Math.random()*canvas.width, y:-50, radius:20+Math.random()*30, speed:2+Math.random()*3});
  setTimeout(spawnMeteor, 1000);
}

function shoot() {
  bullets.push({x:player.x + player.width/2 -5, y:player.y, width:10, height:20, speed:10});
}

if(platform==='pc'){
  document.addEventListener('keydown', e => { keys[e.key.toLowerCase()] = true; if(e.key===' ') shoot(); });
  document.addEventListener('keyup', e => { keys[e.key.toLowerCase()] = false; });
}

// Mobile joystick
const joystickContainer = document.getElementById('joystickContainer');
const joystickThumb = document.getElementById('joystick');
joystickContainer.addEventListener('touchstart', e => { joystick.active=true; updateJoystick(e.touches[0]); });
joystickContainer.addEventListener('touchmove', e => { e.preventDefault(); updateJoystick(e.touches[0]); });
joystickContainer.addEventListener('touchend', e => { joystick.active=false; joystick.x=0; joystick.y=0; joystickThumb.style.transform='translate(25px,25px)'; });

function updateJoystick(touch) {
  let rect = joystickContainer.getBoundingClientRect();
  let x = touch.clientX - rect.left - rect.width/2;
  let y = touch.clientY - rect.top - rect.height/2;
  let max = rect.width/2;
  joystick.x = Math.max(-1, Math.min(1, x/max));
  joystick.y = Math.max(-1, Math.min(1, y/max));
  joystickThumb.style.transform = `translate(${25 + joystick.x*25}px, ${25 + joystick.y*25}px)`;
}

function update() {
  if(platform==='pc'){
    if(keys['a'] && player.x>0) player.x -= player.speed;
    if(keys['d'] && player.x+player.width<canvas.width) player.x += player.speed;
    if(keys['w'] && player.y>0) player.y -= player.speed;
    if(keys['s'] && player.y+player.height<canvas.height) player.y += player.speed;
  } else {
    player.x += joystick.x * player.speed;
    player.y += joystick.y * player.speed;
    if(player.x<0) player.x=0;
    if(player.x+player.width>canvas.width) player.x=canvas.width-player.width;
    if(player.y<0) player.y=0;
    if(player.y+player.height>canvas.height) player.y=canvas.height-player.height;
  }

  bullets.forEach((b,i) => {
    b.y -= b.speed;
    if(b.y < -b.height) bullets.splice(i,1);
  });

  meteors.forEach((m,j) => {
    m.y += m.speed;
    if(m.y - m.radius > canvas.height) meteors.splice(j,1);
    bullets.forEach((b,k)=>{
      let dx = b.x + b.width/2 - m.x;
      let dy = b.y + b.height/2 - m.y;
      if(Math.sqrt(dx*dx + dy*dy) < m.radius){
        meteors.splice(j,1);
        bullets.splice(k,1);
      }
    });
  });
}

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  // Player
  ctx.fillStyle='cyan';
  ctx.fillRect(player.x, player.y, player.width, player.height);

  // Bullets
  ctx.fillStyle='yellow';
  bullets.forEach(b=> ctx.fillRect(b.x,b.y,b.width,b.height));

  // Meteors
  ctx.fillStyle='red';
  meteors.forEach(m=> {
    ctx.beginPath();
    ctx.arc(m.x,m.y,m.radius,0,Math.PI*2);
    ctx.fill();
  });
}

function gameLoop() {
  if(!gameStarted) return;
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

window.addEventListener('resize', () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});
</script>

</body>
</html>
